---
// src/pages/[...slug].astro - ROUTER UNIVERSAL CON MANEJO DEFENSIVO DE ERRORES
import PropertyListLayout from '../layouts/PropertyListLayout.astro';
import SinglePropertyLayout from '../layouts/SinglePropertyLayout.astro';
import Error404Layout from '../layouts/Error404Layout.astro';
import HomepageLayout from '../layouts/HomepageLayout.astro';

// Importar layouts para p√°ginas especiales
import AdvisorsLayout from '../layouts/AdvisorsLayout.astro';
import SingleAdvisorLayout from '../layouts/SingleAdvisorLayout.astro';
import FavoritesLayout from '../layouts/FavoritesLayout.astro';
import SharedFavoritesLayout from '../layouts/SharedFavoritesLayout.astro';

// Importar layouts para testimonios
import TestimonialsMainLayout from '../layouts/TestimonialsMainLayout.astro';
import TestimonialsCategoryLayout from '../layouts/TestimonialsCategoryLayout.astro';
import TestimonialsSingleLayout from '../layouts/TestimonialsSingleLayout.astro';

// Importar layouts para art√≠culos
import ArticlesMainLayout from '../layouts/ArticlesMainLayout.astro';
import ArticlesCategoryLayout from '../layouts/ArticlesCategoryLayout.astro';
import ArticlesSingleLayout from '../layouts/ArticlesSingleLayout.astro';

// Importar layouts para videos
import VideosMainLayout from '../layouts/VideosMainLayout.astro';
import VideosCategoryLayout from '../layouts/VideosCategoryLayout.astro';
import VideosSingleLayout from '../layouts/VideosSingleLayout.astro';

// Importar layouts para contenido y listados curados
import ContactLayout from '../layouts/ContactLayout.astro';
import SellLayout from '../layouts/SellLayout.astro';
import VacationRentalsLayout from '../layouts/VacationRentalsLayout.astro';
import VacationRentalsMainLayout from '../layouts/VacationRentalsMainLayout.astro';
import VacationRentalsDynamicLayout from '../layouts/VacationRentalsDynamicLayout.astro';
import CuratedListingsLayout from '../layouts/CuratedListingsLayout.astro';
import CuratedListingsSingleLayout from '../layouts/CuratedListingsSingleLayout.astro';

// Habilitar SSR para esta p√°gina
export const prerender = false;

console.log('üî• ROUTER START - All layouts imported successfully');

// =====================================================
// CONFIGURACI√ìN DE IDIOMAS Y RUTAS ESPECIALES
// =====================================================

const LANGUAGES = {
  'es': { code: 'es', prefix: '', default: true },
  'en': { code: 'en', prefix: 'en' },
  'fr': { code: 'fr', prefix: 'fr' }
};

const SPECIAL_ROUTES = {
  // Espa√±ol
  'asesores': { type: 'advisors', layout: 'AdvisorsLayout' },
  'favoritos': { type: 'favorites', layout: 'FavoritesLayout', subRoutes: true },
  'testimonios': { type: 'testimonials', layout: 'TestimonialsLayout', subRoutes: true },
  'videos': { type: 'videos', layout: 'VideosLayout', subRoutes: true },
  'articulos': { type: 'articles', layout: 'ArticlesLayout', subRoutes: true },
  'contacto': { type: 'contact', layout: 'ContactLayout' },
  'rentas-vacacionales': { type: 'vacation-rentals', layout: 'VacationRentalsLayout' },
  'planes-rentas-vacacionales': { type: 'vacation-rentals-plans', layout: 'VacationRentalsLayout' },
  'vender': { type: 'sell', layout: 'SellLayout' },
  'listados-de': { type: 'curated-listings', layout: 'CuratedListingsLayout', subRoutes: true },
  
  // Ingl√©s
  'advisors': { type: 'advisors', layout: 'AdvisorsLayout' },
  'favorites': { type: 'favorites', layout: 'FavoritesLayout', subRoutes: true },
  'testimonials': { type: 'testimonials', layout: 'TestimonialsLayout', subRoutes: true },
  'videos': { type: 'videos', layout: 'VideosLayout', subRoutes: true },
  'articles': { type: 'articles', layout: 'ArticlesLayout', subRoutes: true },
  'contact': { type: 'contact', layout: 'ContactLayout' },
  'vacation-rentals': { type: 'vacation-rentals', layout: 'VacationRentalsLayout' },
  'vacation-rental-plans': { type: 'vacation-rentals-plans', layout: 'VacationRentalsLayout' },
  'sell': { type: 'sell', layout: 'SellLayout' },
  'listings-of': { type: 'curated-listings', layout: 'CuratedListingsLayout', subRoutes: true },
  
  // Franc√©s
  'conseillers': { type: 'advisors', layout: 'AdvisorsLayout' },
  'favoris': { type: 'favorites', layout: 'FavoritesLayout', subRoutes: true },
  'temoignages': { type: 'testimonials', layout: 'TestimonialsLayout', subRoutes: true },
  'videos': { type: 'videos', layout: 'VideosLayout', subRoutes: true },
  'articles': { type: 'articles', layout: 'ArticlesLayout', subRoutes: true },
  'contact': { type: 'contact', layout: 'ContactLayout' },
  'locations-vacances': { type: 'vacation-rentals', layout: 'VacationRentalsLayout' },
  'plans-locations-vacances': { type: 'vacation-rentals-plans', layout: 'VacationRentalsLayout' },
  'vendre': { type: 'sell', layout: 'SellLayout' },
  'listes-de': { type: 'curated-listings', layout: 'CuratedListingsLayout', subRoutes: true }
};

// =====================================================
// FUNCIONES UTILITARIAS CON MANEJO DEFENSIVO
// =====================================================

function safeStringProcess(input, defaultValue = '') {
  if (typeof input !== 'string') {
    console.warn('safeStringProcess: input is not a string:', typeof input, input);
    return defaultValue;
  }
  return input;
}

function safeArrayProcess(input, defaultValue = []) {
  if (!Array.isArray(input)) {
    console.warn('safeArrayProcess: input is not an array:', typeof input, input);
    return defaultValue;
  }
  return input;
}

function shouldProcessRoute(urlSegments, pathname) {
  try {
    // Defensive checks
    const safeUrlSegments = safeArrayProcess(urlSegments, []);
    const safePathname = safeStringProcess(pathname, '');

    console.log('üîç shouldProcessRoute check:', {
      segments: safeUrlSegments,
      pathname: safePathname,
      segmentsLength: safeUrlSegments.length
    });

    // EXCLUIR carpeta paginas completa
    if (safePathname.startsWith('/paginas/')) {
      console.log('Excluding /paginas/ from router');
      return false;
    }
    
    // EXCLUIR archivos espec√≠ficos
    if (safePathname === '/sitemap.xml' || safePathname === '/robots.txt') {
      console.log('Excluding sitemap/robots from router');
      return false;
    }
    
    const excludedPaths = [
      'images', 'img', 'assets', 'static', 'public',
      'css', 'js', 'fonts', 'favicon.ico', 
      '_astro', 'api', 'admin', 'wp-admin', 'wp-content',
      '.well-known', 'manifest.json', 'sw.js', 'debug'
    ];
    
    const excludedExtensions = [
      '.jpg', '.jpeg', '.png', '.gif', '.webp', '.svg', '.ico',
      '.css', '.js', '.json', '.txt', '.pdf', '.zip',
      '.woff', '.woff2', '.ttf', '.eot', '.mp4', '.mp3'
    ];
    
    if (safeUrlSegments.length > 0) {
      const firstSegment = safeStringProcess(safeUrlSegments[0], '').toLowerCase();
      if (excludedPaths.includes(firstSegment)) {
        console.log('Excluding path based on first segment:', firstSegment);
        return false;
      }
    }
    
    const lastSegment = safeUrlSegments.length > 0 ? safeStringProcess(safeUrlSegments[safeUrlSegments.length - 1], '') : '';
    if (excludedExtensions.some(ext => lastSegment.toLowerCase().endsWith(ext))) {
      console.log('Excluding based on file extension:', lastSegment);
      return false;
    }
    
    if (excludedExtensions.some(ext => safePathname.toLowerCase().endsWith(ext))) {
      console.log('Excluding based on pathname extension:', safePathname);
      return false;
    }
    
    return true;
  } catch (error) {
    console.error('‚ùå Error in shouldProcessRoute:', error);
    return false; // Safer to exclude on error
  }
}

function parseUrlSegments(urlSegments) {
  try {
    const safeUrlSegments = safeArrayProcess(urlSegments, []);
    
    console.log('üîç parseUrlSegments input:', {
      original: urlSegments,
      safe: safeUrlSegments,
      length: safeUrlSegments.length
    });

    if (safeUrlSegments.length === 0) {
      return {
        language: 'es',
        remainingSegments: [],
        routeType: 'home'
      };
    }

    const firstSegment = safeStringProcess(safeUrlSegments[0], '').toLowerCase();
    
    if (LANGUAGES[firstSegment]) {
      const language = firstSegment;
      const remainingSegments = safeArrayProcess(safeUrlSegments.slice(1), []);
      
      if (remainingSegments.length === 0) {
        return {
          language,
          remainingSegments: [],
          routeType: 'home'
        };
      }
      
      const nextSegment = safeStringProcess(remainingSegments[0], '');
      if (SPECIAL_ROUTES[nextSegment]) {
        return {
          language,
          remainingSegments,
          routeType: 'special',
          specialRoute: SPECIAL_ROUTES[nextSegment]
        };
      }
      
      return {
        language,
        remainingSegments,
        routeType: 'property'
      };
    }
    
    const language = 'es';
    
    if (SPECIAL_ROUTES[firstSegment]) {
      return {
        language,
        remainingSegments: safeUrlSegments,
        routeType: 'special',
        specialRoute: SPECIAL_ROUTES[firstSegment]
      };
    }
    
    return {
      language,
      remainingSegments: safeUrlSegments,
      routeType: 'property'
    };
  } catch (error) {
    console.error('‚ùå Error in parseUrlSegments:', error);
    return {
      language: 'es',
      remainingSegments: [],
      routeType: 'property'
    };
  }
}

// =====================================================
// FUNCIONES PARA LLAMAR BACKENDS CON MANEJO DE ERRORES
// =====================================================

const MAIN_BACKEND_URL = 'https://pacewqgypevfgjmdsorz.supabase.co/functions/v1/backend';
const CONTENT_BACKEND_URL = 'https://pacewqgypevfgjmdsorz.supabase.co/functions/v1/content-backend';
const AUTH_TOKEN = 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBhY2V3cWd5cGV2ZmdqbWRzb3J6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg2NjU4OTksImV4cCI6MjA2NDI0MTg5OX0.Qlg-UVy-sikr76GxYmTcfCz1EnAqPHxvFeLrdqnjuWs';

async function callMainBackend(language, segments, searchParams) {
  try {
    const safeLanguage = safeStringProcess(language, 'es');
    const safeSegments = safeArrayProcess(segments, []);
    const safeSearchParams = safeStringProcess(searchParams, '');

    let routePath = '';
    
    if (safeLanguage !== 'es') {
      routePath = safeLanguage + '/';
    }
    
    if (safeSegments.length > 0) {
      const validSegments = safeSegments.filter(segment => safeStringProcess(segment, '').trim() !== '');
      routePath += validSegments.join('/');
    }
    
    const backendURL = `${MAIN_BACKEND_URL}/${routePath}${safeSearchParams ? `?${safeSearchParams}` : ''}`;
    
    console.log('üéØ Calling main backend:', {
      url: backendURL,
      language: safeLanguage,
      segments: safeSegments
    });
    
    const response = await fetch(backendURL, {
      method: 'GET',
      headers: {
        'Authorization': AUTH_TOKEN,
        'Content-Type': 'application/json',
        'User-Agent': `CLIC-Router/${Astro.url.host}`,
        'X-Original-Host': Astro.url.hostname,
      },
    });

    if (!response.ok) {
      const errorText = await response.text().catch(() => 'Unknown error');
      console.error(`‚ùå Main backend error: ${response.status} - ${errorText}`);
      
      return {
        pageType: '404',
        type: '404',
        language: safeLanguage,
        error: `Backend error: ${response.status}`,
        message: errorText || 'Page not found',
        statusCode: response.status
      };
    }

    const data = await response.json().catch((parseError) => {
      console.error('‚ùå Failed to parse backend response as JSON:', parseError);
      return {
        pageType: '404',
        type: '404',
        language: safeLanguage,
        error: 'Invalid JSON response',
        message: 'Backend returned invalid data',
        statusCode: 500
      };
    });
    
    if (data.error) {
      console.error('‚ùå Main backend returned error:', data.error);
      return {
        pageType: '404',
        type: '404',
        language: safeLanguage,
        error: data.error,
        message: data.message || 'Backend error occurred',
        statusCode: 500
      };
    }
    
    // Asegurar estructura v√°lida con defensas
    if (!data.property && !data.properties && !data.type && !data.pageType) {
      console.error('‚ùå Invalid main backend response structure');
      return {
        pageType: '404',
        type: '404',
        language: safeLanguage,
        error: 'Invalid response structure',
        message: 'No valid content received',
        statusCode: 500
      };
    }
    
    // Defensive data processing
    data.language = safeLanguage;
    
    if (data.type && !data.pageType) {
      data.pageType = data.type;
    }
    
    if (!data.pageType) {
      if (data.property && data.property.id) {
        data.pageType = 'single-property';
      } else if (data.properties && Array.isArray(data.properties)) {
        data.pageType = 'property-list';
      } else {
        data.pageType = '404';
      }
    }
    
    console.log('‚úÖ Main backend response processed:', {
      type: data.pageType,
      language: data.language,
      hasProperties: Array.isArray(data.properties) ? data.properties.length > 0 : false,
      hasProperty: !!(data.property && data.property.id)
    });
    
    return data;
    
  } catch (error) {
    console.error('‚ùå Error calling main backend:', error);
    
    return {
      pageType: '404',
      type: '404',
      language: safeStringProcess(language, 'es'),
      error: error.message,
      message: 'Error connecting to main backend',
      statusCode: 500
    };
  }
}

async function callContentBackend(language, segments, searchParams) {
  try {
    const safeLanguage = safeStringProcess(language, 'es');
    const safeSegments = safeArrayProcess(segments, []);
    const safeSearchParams = safeStringProcess(searchParams, '');

    let routePath = '';
    
    if (safeLanguage !== 'es') {
      routePath = safeLanguage + '/';
    }
    
    if (safeSegments.length > 0) {
      const validSegments = safeSegments.filter(segment => safeStringProcess(segment, '').trim() !== '');
      routePath += validSegments.join('/');
    }
    
    const backendURL = `${CONTENT_BACKEND_URL}/${routePath}${safeSearchParams ? `?${safeSearchParams}` : ''}`;
    
    console.log('üìù Calling content backend:', {
      url: backendURL,
      language: safeLanguage,
      segments: safeSegments
    });
    
    const response = await fetch(backendURL, {
      method: 'GET',
      headers: {
        'Authorization': AUTH_TOKEN,
        'Content-Type': 'application/json',
        'User-Agent': `CLIC-Content/${Astro.url.host}`,
        'X-Original-Host': Astro.url.hostname,
      },
    });

    if (!response.ok) {
      const errorText = await response.text().catch(() => 'Unknown error');
      console.error(`‚ùå Content backend error: ${response.status} - ${errorText}`);
      
      return {
        pageType: '404',
        type: '404',
        language: safeLanguage,
        error: `Content backend error: ${response.status}`,
        message: errorText || 'Content not found',
        statusCode: response.status
      };
    }

    const data = await response.json().catch((parseError) => {
      console.error('‚ùå Failed to parse content backend response as JSON:', parseError);
      return {
        pageType: '404',
        type: '404',
        language: safeLanguage,
        error: 'Invalid JSON response',
        message: 'Content backend returned invalid data',
        statusCode: 500
      };
    });
    
    if (data.error) {
      console.error('‚ùå Content backend returned error:', data.error);
      return {
        pageType: '404',
        type: '404',
        language: safeLanguage,
        error: data.error,
        message: data.message || 'Content error occurred',
        statusCode: 500
      };
    }
    
    data.language = safeLanguage;
    
    if (data.type && !data.pageType) {
      data.pageType = data.type;
    }
    
    console.log('‚úÖ Content backend response processed:', {
      type: data.pageType,
      language: data.language,
      contentType: data.contentType
    });
    
    return data;
    
  } catch (error) {
    console.error('‚ùå Error calling content backend:', error);
    
    return {
      pageType: '404',
      type: '404',
      language: safeStringProcess(language, 'es'),
      error: error.message,
      message: 'Error connecting to content backend',
      statusCode: 500
    };
  }
}

// =====================================================
// PROCESAMIENTO PRINCIPAL CON MANEJO DEFENSIVO
// =====================================================

let pageData = null;
let pageType = 'unknown';

try {
  console.log('üî• ROUTER START - Processing request...');

  // Defensive parameter extraction
  const { slug } = Astro.params;
  const pathname = safeStringProcess(Astro.url.pathname, '/');
  
  console.log('üîç Initial router data:', {
    slug: slug,
    slugType: typeof slug,
    pathname: pathname,
    astroUrl: Astro.url.href
  });

  // Safe URL segments processing
  let urlSegments = [];
  try {
    if (slug && typeof slug === 'string') {
      urlSegments = slug.split('/').filter(Boolean);
    } else if (slug && Array.isArray(slug)) {
      urlSegments = slug.filter(segment => safeStringProcess(segment, '').trim() !== '');
    } else {
      urlSegments = [];
    }
  } catch (segmentError) {
    console.error('‚ùå Error processing slug segments:', segmentError);
    urlSegments = [];
  }

  // Ensure urlSegments is always an array
  urlSegments = safeArrayProcess(urlSegments, []);

  console.log('üîß Processed router data:', {
    urlSegments: urlSegments,
    segmentsLength: urlSegments.length,
    pathname: pathname
  });

  // MANEJO ESPECIAL PARA RUTAS RA√çZ Y HOMEPAGE
  if (!slug || urlSegments.length === 0) {
    // Si es la ruta ra√≠z (/), tratarla como homepage en espa√±ol
    if (pathname === '/' || pathname === '') {
      console.log('üè† Processing root homepage (espa√±ol)');
      const homeData = await callContentBackend('es', [], Astro.url.searchParams.toString());
      pageData = homeData;
      pageType = homeData.pageType || 'homepage';
    } else {
      // Extraer segmentos del pathname como fallback
      try {
        const pathSegments = pathname.split('/').filter(Boolean);
        urlSegments = safeArrayProcess(pathSegments, []);
        
        if (!shouldProcessRoute(urlSegments, pathname)) {
          console.log('‚ùå Excluded pathname route:', pathname);
          throw new Error('Pathname route excluded');
        }
      } catch (pathError) {
        console.error('‚ùå Error processing pathname:', pathError);
        throw new Error('Invalid pathname processing');
      }
    }
  }

  // Si no se proces√≥ como homepage ra√≠z, continuar con l√≥gica normal
  if (!pageData) {
    if (!shouldProcessRoute(urlSegments, pathname)) {
      console.log('‚ùå Excluded route:', pathname);
      throw new Error('Route excluded');
    }

    const parsedRoute = parseUrlSegments(urlSegments);
    const searchParams = safeStringProcess(Astro.url.searchParams.toString(), '');

    console.log('üìù Parsed route:', parsedRoute);

    switch (parsedRoute.routeType) {
      case 'home':
        console.log('üè† Processing home page via content backend');
        const homeData = await callContentBackend(parsedRoute.language, [], searchParams);
        pageData = homeData;
        pageType = homeData.pageType || 'homepage';
        break;
      
      case 'special':
        console.log('‚≠ê Processing special route via content backend:', parsedRoute.specialRoute?.type);
        const contentData = await callContentBackend(parsedRoute.language, parsedRoute.remainingSegments, searchParams);
        pageData = contentData;
        pageType = contentData.pageType || '404';
        break;
      
      case 'property':
        console.log('üèòÔ∏è Processing property route via main backend');
        const backendData = await callMainBackend(parsedRoute.language, parsedRoute.remainingSegments, searchParams);
        pageData = backendData;
        pageType = backendData.pageType || '404';
        
        const validPageTypes = ['single-property', 'property-list', '404'];
        if (!validPageTypes.includes(pageType)) {
          console.warn(`‚ùå Invalid pageType received: ${pageType}, defaulting to 404`);
          pageType = '404';
          pageData.pageType = '404';
        }
        break;
      
      default:
        console.log('‚ùì Unknown route type');
        pageData = {
          pageType: '404',
          type: '404',
          language: parsedRoute.language || 'es',
          originalUrl: pathname,
          message: 'Route not found'
        };
        pageType = '404';
        break;
    }
  }
  
} catch (error) {
  console.error('‚ùå Error processing page:', error);
  
  pageData = {
    pageType: '404',
    type: '404',
    language: 'es',
    originalUrl: safeStringProcess(Astro.url.pathname, '/'),
    error: error.message,
    message: 'An error occurred while processing the page'
  };
  pageType = '404';
}

// Validaci√≥n final para 404 con defensas
if (pageType === '404' || !pageData) {
  if (!pageData) {
    pageData = {
      pageType: '404',
      type: '404',
      language: 'es',
      originalUrl: safeStringProcess(Astro.url.pathname, '/'),
      message: 'Page not found'
    };
  } else {
    pageData.pageType = '404';
    pageData.type = '404';
    pageData.language = safeStringProcess(pageData.language, 'es');
    pageData.message = safeStringProcess(pageData.message, 'Page not found');
  }
  
  console.log('üîß Setting status 200 for custom 404 layout');
}

console.log('‚úÖ Page ready for render:', {
  pageType: pageType,
  hasContent: !!pageData,
  hasGlobalConfig: !!(pageData && pageData.globalConfig),
  finalPageDataKeys: pageData ? Object.keys(pageData) : []
});

// Variables de renderizado con validaci√≥n defensiva
const showHomepage = pageType === 'homepage';
const showPropertyList = pageType === 'property-list';
const showSingleProperty = pageType === 'single-property';
const showAdvisorsList = pageType === 'advisors-list' || pageType === 'advisors-main';
const showAdvisorSingle = pageType === 'advisor-single';
const showFavoritesMain = pageType === 'favorites-main';
const showFavoritesShared = pageType === 'favorites-shared';
const showTestimonialsMain = pageType === 'testimonials-main';
const showTestimonialsCategory = pageType === 'testimonials-category';
const showTestimonialsSingle = pageType === 'testimonials-single';
const showArticlesMain = pageType === 'articles-main';
const showArticlesCategory = pageType === 'articles-category';
const showArticlesSingle = pageType === 'articles-single' || pageType === 'articles-single-404';
const showVideosMain = pageType === 'videos-main';
const showVideosCategory = pageType === 'videos-category';
const showVideosSingle = pageType === 'videos-single';
const showContact = pageType === 'contact';
const showSell = pageType === 'sell';
const showVacationRentalsMain = pageType === 'vacation-rentals-main';
const showVacationRentalsPlans = pageType === 'vacation-rentals-plans';
const showVacationRentalsDynamic = pageType === 'vacation-rentals-dynamic';
const showCuratedListingsMain = pageType === 'curated-listings-main';
const showCuratedListingsSingle = pageType === 'curated-listings-single';
const show404 = pageType === '404' || pageType === 'unknown';

console.log('üî® Final render decision:', {
  pageType,
  showHomepage,
  show404,
  showPropertyList,
  showSingleProperty,
  showCuratedListingsMain,
  showCuratedListingsSingle
});

// Asegurar que pageData tenga estructura m√≠nima
if (!pageData) {
  pageData = {
    pageType: '404',
    type: '404',
    language: 'es',
    message: 'No data available'
  };
}

// Asegurar language por defecto
if (!pageData.language) {
  pageData.language = 'es';
}
---

{showHomepage && <HomepageLayout data={pageData} language={pageData?.language || 'es'} />}

{show404 && (
  <Error404Layout data={pageData} language={pageData?.language || 'es'} />
)}

{showPropertyList && <PropertyListLayout data={pageData} language={pageData?.language || 'es'} />}

{showSingleProperty && <SinglePropertyLayout data={pageData} language={pageData?.language || 'es'} />}

{showAdvisorsList && <AdvisorsLayout data={pageData} language={pageData?.language || 'es'} />}

{showAdvisorSingle && <SingleAdvisorLayout data={pageData} language={pageData?.language || 'es'} />}

{showFavoritesMain && <FavoritesLayout data={pageData} language={pageData?.language || 'es'} />}

{showFavoritesShared && <SharedFavoritesLayout data={pageData} language={pageData?.language || 'es'} />}

{showTestimonialsMain && <TestimonialsMainLayout data={pageData} language={pageData?.language || 'es'} />}

{showTestimonialsCategory && <TestimonialsCategoryLayout data={pageData} language={pageData?.language || 'es'} />}

{showTestimonialsSingle && <TestimonialsSingleLayout data={pageData} language={pageData?.language || 'es'} />}

{showArticlesMain && <ArticlesMainLayout data={pageData} language={pageData?.language || 'es'} />}

{showArticlesCategory && <ArticlesCategoryLayout data={pageData} language={pageData?.language || 'es'} />}

{showArticlesSingle && <ArticlesSingleLayout data={pageData} language={pageData?.language || 'es'} />}

{showVideosMain && <VideosMainLayout data={pageData} language={pageData?.language || 'es'} />}

{showVideosCategory && <VideosCategoryLayout data={pageData} language={pageData?.language || 'es'} />}

{showVideosSingle && <VideosSingleLayout data={pageData} language={pageData?.language || 'es'} />}

{showContact && <ContactLayout data={pageData} language={pageData?.language || 'es'} />}

{showSell && <SellLayout data={pageData} language={pageData?.language || 'es'} />}

{showVacationRentalsMain && <VacationRentalsMainLayout data={pageData} language={pageData?.language || 'es'} />}

{showVacationRentalsPlans && <VacationRentalsLayout data={pageData} language={pageData?.language || 'es'} />}

{showVacationRentalsDynamic && <VacationRentalsDynamicLayout data={pageData} language={pageData?.language || 'es'} />}

{showCuratedListingsMain && <CuratedListingsLayout data={pageData} language={pageData?.language || 'es'} />}

{showCuratedListingsSingle && <CuratedListingsSingleLayout data={pageData} language={pageData?.language || 'es'} />}