---
// src/layouts/VideosSingleLayout.astro - Layout para video individual
import Layout from './Layout.astro';
import PropertyCarousel from '../components/PropertyCarousel.astro';
import VideoGallery from '../components/VideoGallery.astro';
import AreaAdvisors from '../components/AreaAdvisors.astro';

// ===================================================================
// EXTRACCI√ìN DE DATOS DEL PROP
// ===================================================================

const { data } = Astro.props;
const language = data?.language || 'es';
const categorySlug = data?.categorySlug || data?.category;
const videoSlug = data?.videoSlug || data?.slug;

// ===================================================================
// DATOS EST√ÅTICOS DE FALLBACK 
// ===================================================================

let videoData = data;

// Si no hay datos, usar fallback est√°tico
if (!videoData || !videoData.title) {
  console.log('üìπ VideosSingleLayout: Usando datos est√°ticos de fallback');
  
  videoData = {
    language: language,
    slug: videoSlug || 'la-casa-de-luz-garcia',
    categorySlug: categorySlug || 'la-casa-de-los-famosos',
    title: language === 'es' ? 'La Casa de Luz Garc√≠a en Cacicazgos' :
           language === 'en' ? 'Luz Garc√≠a\'s House in Cacicazgos' :
           'La Maison de Luz Garc√≠a √† Cacicazgos',
    subtitle: language === 'es' ? 'Tour exclusivo por la espectacular villa de la presentadora dominicana' :
              language === 'en' ? 'Exclusive tour of the Dominican TV host\'s spectacular villa' :
              'Visite exclusive de la villa spectaculaire de la pr√©sentatrice dominicaine',
    description: language === 'es' ? `Acomp√°√±anos en este recorrido exclusivo por la impresionante villa de Luz Garc√≠a ubicada en el exclusivo sector de Cacicazgos. 
    
    Esta propiedad de m√°s de 450 metros cuadrados combina elegancia moderna con toques tropicales, creando el hogar perfecto para una de las figuras m√°s queridas de la televisi√≥n dominicana.
    
    Caracter√≠sticas destacadas:
    ‚Ä¢ 5 habitaciones con ba√±o privado
    ‚Ä¢ Cocina gourmet con isla central
    ‚Ä¢ Sala de entretenimiento y bar
    ‚Ä¢ Piscina infinita con vista al jard√≠n
    ‚Ä¢ Gazebo y √°rea de BBQ
    ‚Ä¢ Gimnasio privado
    ‚Ä¢ Oficina en casa
    
    La decoraci√≥n, supervisada personalmente por Luz, refleja su estilo sofisticado pero acogedor, con obras de arte dominicano y mobiliario importado.` :
    language === 'en' ? `Join us on this exclusive tour of Luz Garc√≠a's impressive villa located in the exclusive Cacicazgos sector.
    
    This property of more than 450 square meters combines modern elegance with tropical touches, creating the perfect home for one of the most beloved figures on Dominican television.
    
    Featured characteristics:
    ‚Ä¢ 5 bedrooms with private bathroom
    ‚Ä¢ Gourmet kitchen with central island
    ‚Ä¢ Entertainment room and bar
    ‚Ä¢ Infinity pool with garden view
    ‚Ä¢ Gazebo and BBQ area
    ‚Ä¢ Private gym
    ‚Ä¢ Home office
    
    The decoration, personally supervised by Luz, reflects her sophisticated but cozy style, with Dominican artwork and imported furniture.` :
    `Rejoignez-nous dans cette visite exclusive de l'impressionnante villa de Luz Garc√≠a situ√©e dans le secteur exclusif de Cacicazgos.
    
    Cette propri√©t√© de plus de 450 m√®tres carr√©s combine √©l√©gance moderne et touches tropicales, cr√©ant la maison parfaite pour l'une des figures les plus aim√©es de la t√©l√©vision dominicaine.
    
    Caract√©ristiques en vedette:
    ‚Ä¢ 5 chambres avec salle de bain priv√©e
    ‚Ä¢ Cuisine gastronomique avec √Ælot central
    ‚Ä¢ Salle de divertissement et bar
    ‚Ä¢ Piscine √† d√©bordement avec vue sur le jardin
    ‚Ä¢ Gazebo et espace BBQ
    ‚Ä¢ Gymnase priv√©
    ‚Ä¢ Bureau √† domicile
    
    La d√©coration, personnellement supervis√©e par Luz, refl√®te son style sophistiqu√© mais chaleureux, avec des ≈ìuvres d'art dominicaines et du mobilier import√©.`,
    videoId: 'dQw4w9WgXcQ',
    duration: '18:45',
    views: '342,567',
    publishedAt: '2024-03-15',
    category: language === 'es' ? 'La Casa de los Famosos' :
              language === 'en' ? 'Celebrity Homes' :
              'Maisons des C√©l√©brit√©s',
    location: 'Cacicazgos, Santo Domingo',
    propertyType: language === 'es' ? 'Villa de Lujo' :
                  language === 'en' ? 'Luxury Villa' :
                  'Villa de Luxe',
    
    // Galer√≠a de fotos adicionales
    photoGallery: [
      {
        url: 'https://images.unsplash.com/photo-1613977257363-707ba9348227?w=1200&h=800&fit=crop',
        caption: language === 'es' ? 'Fachada principal de la villa' :
                 language === 'en' ? 'Main facade of the villa' :
                 'Fa√ßade principale de la villa'
      },
      {
        url: 'https://images.unsplash.com/photo-1600607687644-aac4c3eac7f4?w=1200&h=800&fit=crop',
        caption: language === 'es' ? 'Sala principal con doble altura' :
                 language === 'en' ? 'Main living room with double height' :
                 'Salon principal avec double hauteur'
      },
      {
        url: 'https://images.unsplash.com/photo-1600607687920-4e2a09cf159d?w=1200&h=800&fit=crop',
        caption: language === 'es' ? 'Cocina gourmet' :
                 language === 'en' ? 'Gourmet kitchen' :
                 'Cuisine gastronomique'
      },
      {
        url: 'https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=1200&h=800&fit=crop',
        caption: language === 'es' ? 'Master bedroom con vista al jard√≠n' :
                 language === 'en' ? 'Master bedroom with garden view' :
                 'Chambre principale avec vue sur le jardin'
      },
      {
        url: 'https://images.unsplash.com/photo-1600047509807-ba8f99d2cdde?w=1200&h=800&fit=crop',
        caption: language === 'es' ? '√Årea de piscina y entretenimiento' :
                 language === 'en' ? 'Pool and entertainment area' :
                 'Zone piscine et divertissement'
      },
      {
        url: 'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?w=1200&h=800&fit=crop',
        caption: language === 'es' ? 'Gazebo y √°rea de BBQ' :
                 language === 'en' ? 'Gazebo and BBQ area' :
                 'Gazebo et zone BBQ'
      }
    ],
    
    // Propiedades similares disponibles
    similarProperties: [
      {
        slug: 'villa-cacicazgos-moderna',
        titulo: language === 'es' ? 'Villa Moderna en Cacicazgos' :
                language === 'en' ? 'Modern Villa in Cacicazgos' :
                'Villa Moderne √† Cacicazgos',
        precio: '$950,000',
        imagen: 'https://images.unsplash.com/photo-1613490493576-7fde63acd811?w=800&h=600&fit=crop',
        sector: 'Cacicazgos',
        habitaciones: 5,
        banos: 5,
        metros: 480,
        tipo: language === 'es' ? 'Villa de Lujo' : language === 'en' ? 'Luxury Villa' : 'Villa de Luxe',
        destacado: true
      },
      {
        slug: 'villa-arroyo-hondo-premium',
        titulo: language === 'es' ? 'Villa Premium en Arroyo Hondo' :
                language === 'en' ? 'Premium Villa in Arroyo Hondo' :
                'Villa Premium √† Arroyo Hondo',
        precio: '$750,000',
        imagen: 'https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?w=800&h=600&fit=crop',
        sector: 'Arroyo Hondo',
        habitaciones: 4,
        banos: 4,
        metros: 420,
        tipo: language === 'es' ? 'Villa' : 'Villa'
      }
    ],
    
    // Videos relacionados
    relatedVideos: [
      {
        id: '1',
        title: language === 'es' ? 'El Penthouse de Romeo Santos en Naco' :
               language === 'en' ? 'Romeo Santos\' Penthouse in Naco' :
               'Le Penthouse de Romeo Santos √† Naco',
        thumbnail: 'https://images.unsplash.com/photo-1600607687644-aac4c3eac7f4?w=800&h=450&fit=crop',
        duration: '22:30',
        views: '289K',
        category: 'casa-famosos',
        videoId: 'xxx'
      },
      {
        id: '2',
        title: language === 'es' ? 'La Villa de Juan Luis Guerra' :
               language === 'en' ? 'Juan Luis Guerra\'s Villa' :
               'La Villa de Juan Luis Guerra',
        thumbnail: 'https://images.unsplash.com/photo-1600607687920-4e2a09cf159d?w=800&h=450&fit=crop',
        duration: '25:12',
        views: '567K',
        category: 'casa-famosos',
        videoId: 'xxx'
      },
      {
        id: '3',
        title: language === 'es' ? '5 Tips de decoraci√≥n estilo Luz Garc√≠a' :
               language === 'en' ? '5 Luz Garc√≠a style decoration tips' :
               '5 Conseils de d√©coration style Luz Garc√≠a',
        thumbnail: 'https://images.unsplash.com/photo-1600210492486-724fe5c67fb0?w=800&h=450&fit=crop',
        duration: '12:45',
        views: '89K',
        category: 'decoracion',
        videoId: 'xxx'
      }
    ],
    
    // Asesores especializados en la zona
    areaAdvisors: [
      {
        slug: 'maria-rodriguez',
        name: 'Mar√≠a Rodr√≠guez',
        title: language === 'es' ? 'Especialista en Propiedades de Lujo' :
               language === 'en' ? 'Luxury Properties Specialist' :
               'Sp√©cialiste en Propri√©t√©s de Luxe',
        avatar: 'https://i.pravatar.cc/150?img=5',
        specialties: ['Cacicazgos', 'Arroyo Hondo', 'Los R√≠os'],
        areas: [language === 'es' ? 'Propiedades de Lujo' : language === 'en' ? 'Luxury Properties' : 'Propri√©t√©s de Luxe', language === 'es' ? 'Villas' : 'Villas'],
        languages: [language === 'es' ? 'Espa√±ol' : language === 'en' ? 'Spanish' : 'Espagnol', language === 'es' ? 'Ingl√©s' : language === 'en' ? 'English' : 'Anglais', language === 'es' ? 'Franc√©s' : language === 'en' ? 'French' : 'Fran√ßais'],
        phone: '+1 809 555 0101',
        whatsapp: '18095550101',
        rating: 4.9,
        reviewCount: 127
      }
    ],
    
    seo: {
      title: language === 'es' ? 'La Casa de Luz Garc√≠a en Cacicazgos - Video CLIC' :
             language === 'en' ? 'Luz Garc√≠a\'s House in Cacicazgos - CLIC Video' :
             'La Maison de Luz Garc√≠a √† Cacicazgos - Vid√©o CLIC',
      description: language === 'es' ? 'Tour exclusivo por la espectacular villa de la presentadora dominicana' :
                   language === 'en' ? 'Exclusive tour of the Dominican TV host\'s spectacular villa' :
                   'Visite exclusive de la villa spectaculaire de la pr√©sentatrice dominicaine'
    }
  };
}

// ===================================================================
// PROCESAR DATOS FINALES
// ===================================================================

const similarProperties = videoData.similarProperties || [];
const relatedVideos = videoData.relatedVideos || [];
const areaAdvisors = videoData.areaAdvisors || [];
const photoGallery = videoData.photoGallery || [];

// ===================================================================
// TEXTOS POR IDIOMA
// ===================================================================

const TEXTS = {
  es: {
    breadcrumbVideos: 'Videos',
    description: 'Descripci√≥n',
    photoGalleryTitle: 'Galer√≠a de Fotos Exclusivas',
    similarPropertiesTitle: 'Propiedades similares disponibles',
    similarPropertiesSubtitle: 'Encuentra tu hogar ideal en las mejores zonas de Santo Domingo',
    relatedVideosTitle: 'Videos que te pueden interesar',
    relatedVideosSubtitle: 'Contin√∫a explorando propiedades exclusivas',
    advisorsTitle: 'Asesores especializados en propiedades de lujo',
    ctaTitle: '¬øTe gust√≥ esta propiedad?',
    ctaSubtitle: 'Podemos mostrarte propiedades similares disponibles en las mejores zonas',
    ctaButton1: 'Agenda una visita',
    ctaButton2: 'Ver propiedades en',
    views: 'vistas',
    duration: 'Duraci√≥n',
    published: 'Publicado el',
    location: 'Ubicaci√≥n',
    propertyType: 'Tipo de propiedad'
  },
  en: {
    breadcrumbVideos: 'Videos',
    description: 'Description',
    photoGalleryTitle: 'Exclusive Photo Gallery',
    similarPropertiesTitle: 'Similar properties available',
    similarPropertiesSubtitle: 'Find your ideal home in the best areas of Santo Domingo',
    relatedVideosTitle: 'Videos that might interest you',
    relatedVideosSubtitle: 'Continue exploring exclusive properties',
    advisorsTitle: 'Advisors specialized in luxury properties',
    ctaTitle: 'Did you like this property?',
    ctaSubtitle: 'We can show you similar properties available in the best areas',
    ctaButton1: 'Schedule a visit',
    ctaButton2: 'View properties in',
    views: 'views',
    duration: 'Duration',
    published: 'Published on',
    location: 'Location',
    propertyType: 'Property type'
  },
  fr: {
    breadcrumbVideos: 'Vid√©os',
    description: 'Description',
    photoGalleryTitle: 'Galerie de Photos Exclusives',
    similarPropertiesTitle: 'Propri√©t√©s similaires disponibles',
    similarPropertiesSubtitle: 'Trouvez votre maison id√©ale dans les meilleures zones de Santo Domingo',
    relatedVideosTitle: 'Vid√©os qui pourraient vous int√©resser',
    relatedVideosSubtitle: 'Continuez √† explorer des propri√©t√©s exclusives',
    advisorsTitle: 'Conseillers sp√©cialis√©s en propri√©t√©s de luxe',
    ctaTitle: 'Cette propri√©t√© vous a plu?',
    ctaSubtitle: 'Nous pouvons vous montrer des propri√©t√©s similaires disponibles dans les meilleures zones',
    ctaButton1: 'Planifier une visite',
    ctaButton2: 'Voir les propri√©t√©s √†',
    views: 'vues',
    duration: 'Dur√©e',
    published: 'Publi√© le',
    location: 'Emplacement',
    propertyType: 'Type de propri√©t√©'
  }
};

const text = TEXTS[language] || TEXTS.es;

// URLs seg√∫n idioma
const routes = {
  es: {
    contact: '/contacto',
    properties: '/comprar',
    videosBase: '/videos'
  },
  en: {
    contact: '/en/contact',
    properties: '/en/buy',
    videosBase: '/en/videos'
  },
  fr: {
    contact: '/fr/contact',
    properties: '/fr/acheter',
    videosBase: '/fr/videos'
  }
};

const currentRoutes = routes[language] || routes.es;

// Funci√≥n para formatear fecha
function formatDate(dateString) {
  const date = new Date(dateString);
  const months = {
    es: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
    en: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
    fr: ['Janvier', 'F√©vrier', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Ao√ªt', 'Septembre', 'Octobre', 'Novembre', 'D√©cembre']
  };
  
  const monthNames = months[language] || months.es;
  return `${date.getDate()} de ${monthNames[date.getMonth()]} ${date.getFullYear()}`;
}

console.log('‚úÖ VideosSingleLayout preparado:', {
  language,
  categorySlug,
  videoSlug,
  title: videoData.title,
  similarPropertiesCount: similarProperties.length,
  relatedVideosCount: relatedVideos.length
});
---

<Layout 
  title={videoData.seo?.title || `${videoData.title} - Video CLIC`}
  description={videoData.seo?.description || videoData.subtitle}
  language={language}
>
  <!-- Breadcrumbs -->
  <section class="bg-gray-50 py-4">
    <div class="container mx-auto px-4">
      <nav class="text-sm text-gray-600">
        <a href={currentRoutes.videosBase} class="hover:text-[#f04e00]">{text.breadcrumbVideos}</a>
        <span class="mx-2">/</span>
        <a href={`${currentRoutes.videosBase}/${videoData.categorySlug}`} class="hover:text-[#f04e00]">
          {videoData.category}
        </a>
        <span class="mx-2">/</span>
        <span class="text-gray-900">{videoData.title}</span>
      </nav>
    </div>
  </section>

  <!-- Video Section -->
  <section class="py-8">
    <div class="container mx-auto px-4">
      <div class="max-w-6xl mx-auto">
        <!-- Title and metadata -->
        <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-2">
          {videoData.title}
        </h1>
        <p class="text-xl text-gray-600 mb-6">{videoData.subtitle}</p>
        
        <div class="flex flex-wrap items-center gap-4 text-sm text-gray-600 mb-8">
          <span class="flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
            </svg>
            {videoData.views} {text.views}
          </span>
          <span class="flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
            </svg>
            {formatDate(videoData.publishedAt)}
          </span>
          <span class="flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            {videoData.location}
          </span>
          <span class="flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
            </svg>
            {videoData.propertyType}
          </span>
        </div>

        <!-- Video Embed -->
        <div class="aspect-video bg-black rounded-xl overflow-hidden shadow-2xl mb-8">
          <iframe 
            src={`https://www.youtube.com/embed/${videoData.videoId}`}
            title={videoData.title}
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen
            class="w-full h-full"
          ></iframe>
        </div>

        <!-- Description -->
        <div class="prose prose-lg max-w-none mb-12">
          <h2 class="text-2xl font-bold mb-4">{text.description}</h2>
          <div class="whitespace-pre-line text-gray-700">{videoData.description}</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Photo Gallery -->
  {photoGallery.length > 0 && (
    <section class="py-12 bg-gray-50">
      <div class="container mx-auto px-4">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-8">
          {text.photoGalleryTitle}
        </h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {photoGallery.map((photo, index) => (
            <div class="group cursor-pointer">
              <div class="aspect-[4/3] overflow-hidden rounded-lg shadow-md group-hover:shadow-xl transition-shadow">
                <img 
                  src={photo.url} 
                  alt={photo.caption}
                  class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                />
              </div>
              <p class="mt-2 text-sm text-gray-600 text-center">{photo.caption}</p>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Similar Properties -->
  {similarProperties.length > 0 && (
    <PropertyCarousel 
      title={text.similarPropertiesTitle}
      subtitle={text.similarPropertiesSubtitle}
      properties={similarProperties}
      viewAllLink={`${currentRoutes.properties}/villa/santo-domingo?zona=norte`}
      language={language}
    />
  )}

  <!-- Related Videos -->
  {relatedVideos.length > 0 && (
    <VideoGallery 
      videos={relatedVideos}
      title={text.relatedVideosTitle}
      subtitle={text.relatedVideosSubtitle}
      language={language}
    />
  )}

  <!-- Area Advisors -->
  {areaAdvisors.length > 0 && (
    <AreaAdvisors 
      advisors={areaAdvisors}
      title={text.advisorsTitle}
      location="Santo Domingo Norte"
      language={language}
    />
  )}

  <!-- CTA Section -->
  <section class="py-16 bg-gradient-to-r from-[#f04e00] to-[#ff7a3d]">
    <div class="container mx-auto px-4 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">
        {text.ctaTitle}
      </h2>
      <p class="text-xl text-white/90 mb-8 max-w-2xl mx-auto">
        {text.ctaSubtitle}
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a 
          href={currentRoutes.contact} 
          class="inline-block px-8 py-3 bg-white text-[#f04e00] rounded-lg hover:bg-gray-100 transition-colors font-medium"
        >
          {text.ctaButton1}
        </a>
        <a 
          href={`${currentRoutes.properties}/villa/${videoData.location.toLowerCase().replace(/,.*/, '').replace(/\s+/g, '-')}`}
          class="inline-block px-8 py-3 bg-white/20 text-white border border-white rounded-lg hover:bg-white/30 transition-colors font-medium"
        >
          {text.ctaButton2} {videoData.location.split(',')[0]}
        </a>
      </div>
    </div>
  </section>
</Layout>